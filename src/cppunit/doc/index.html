<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="Baptiste Lepilleur">
   <meta name="GENERATOR" content="Mozilla/4.7 [en] (WinNT; I) [Netscape]">
   <title>Cpp Unit, Windows Edition</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">

<center>
<h2>
Cpp Unit, Windows Edition</h2></center>

<hr WIDTH="100%">Lastest changes
<ul>
<li>
2001/04/28: <a href="CppUnitW-1_2.zip">CppUnitW 1.2</a>:</li>

<ul>
<li>
CppUnit:</li>

<ul>
<li>
The directory layout have been changed, and CppUnitW is based on the <a href="http://sourceforge.net/projects/cppunit/">sourceforge
version</a>.</li>

<li>
Macros are now in header &lt;cppunit/extensions/HelperMacros.h>.</li>

<li>
The new include paths are: "<tt><i>topdir</i>/include/cppunit</tt>" and
"<tt><i>topdir</i>/include/msvc6/tesrunner</tt>" for the testrunner.</li>

<li>
The test registry is not used anymore, instead a test factory registry
is used. This allow to keep the original ownership semantic of the test
runner. The test runner owns the test.</li>

<li>
If you intend to switch to the official sourceforge release, it would be
better to stick to the <i>TestSuiteBuilder</i> class and not use the macros.
They might not go in (not my choice).</li>

<li>
Added a constructor to <i>TestSuite</i> which take a <i>type_info</i>.</li>

<li>
Write on the <a href="http://sourceforge.net/projects/cppunit/">cppunit
mailing list</a> if you want to discuss features (such as add-ins integration).</li>
</ul>

<li>
TestRunner:</li>

<ul>
<li>
Modified so that it does always own the test.</li>

<li>
The test runner dialog is not exported any more. The wrapper is exported
in <tt>"TestRunner.h"</tt>. See <a href="#UsingTheTestRunner">Using TestRunner
from your application</a> for detail.</li>

<li>
The new include path is: "<tt><i>topdir</i>/include/msvc6/tesrunner</tt>"
for the testrunner.</li>

<li>
Started extracting logic from the dialog to a model (class <i>TestRunnerModel</i>).</li>
</ul>
</ul>

<li>
2001/04/17: <a href="CppUnitW-1_1.zip">CppUnitW 1.1</a>:</li>

<ul>
<li>
CppUnit:</li>

<ul>
<li>
Removed the <i>tassert</i> instead of <i>assert</i>. Thinking back on the
problem, I'd rather want to know that a test failed than have to deal with
the assertion failure. May original fear was about non exception safe code,
but it with only most likely cause memory leaks on test failure.</li>
</ul>

<li>
TestRunner:</li>

<ul>
<li>
<i>Resource.h</i> is no longer included in <i>TestRunnerDlg.h</i> to having
conflict with the host application resources.</li>

<li>
If you press the letter 'Q' in the test runner, it will send a WM_QUIT
message to the host application (therefore closing it!). A very useful
shortcut when you run your test very often.</li>
</ul>
</ul>

<li>
2001/04/16: <a href="CppUnitW-1_0.zip">CppUnitW 1.0</a> is out. Macros
helper and the graphic test runner works.</li>
</ul>

<hr WIDTH="100%">
<h2>
Content</h2>
<a href="#Overview">Overview</a>
<br><a href="#Requirement">Requirement</a>
<br><a href="#Licensing">Licensing</a>
<br><a href="#Download">Download</a>
<br><a href="#Questions">Questions, comments and bugs reports</a>
<br><a href="#GettingStarted">Getting Started</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#CompilingTheSample">Compiling the samples</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#UsingTheTestRunner">Using the test runner</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#CreatingTestCase">Creating test case</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#TheWayOfMacros">The
way of macros</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#TheWayOfTemplates">The
way of templates</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#UsingTheTestRunner">Using TestRunner from
your application</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#CompilingWithCppUnit">Compiling with CppUnit
and TestRunner</a>
<br><a href="#KnownBugs">Known bugs</a>
<h2>
<a NAME="Overview"></a>Overview</h2>
&nbsp;&nbsp;&nbsp; CppUnit is a C++ unit testing framework base on <a href="http://www.junit.org">junit</a>.
See the links below for details.
<br>&nbsp;&nbsp;&nbsp; CppUnit can be found at <a href="http://sourceforge.net/projects/cppunit/">http://sourceforge.net/projects/cppunit/</a>.It
is based on a version that was Windows specific (can be found at <a href="http://www.xprogramming.org">http://www.xprogramming.org</a>).
There was many features I wanted to add to CppUnit.
<br>&nbsp;&nbsp;&nbsp; The version of CppUnit you can found here is what
the sourceforge release will look like once everything is integrated. At
the current only the core cppunit lib have been integrated. The patch for
the testrunner (original version) has been submitted. I'm waiting the integration
of this one to post the others patches (TestSuiteBuilder).
<p>&nbsp;&nbsp;&nbsp; The changes made to CppUnit are:
<ul>
<li>
Compile correctly with VC++ (mainly missing std::).</li>

<li>
Macros and template (TestSuiteBuilder) to help defining the static methods
suite() on test case, and automatically registers those suite to the test
registry (it's optional),</li>

<li>
The graphic test runner of the original version of CppUnit can now be used,</li>

<li>
A browser has been added to select the test to run in,</li>

<li>
The combo box that was used to select the test to run now contains the
most recently tests instead of all the top level tests,</li>

<li>
The test that has been last used can be automatically run when the test
runner is opened.</li>

<li>
A <i>TestAssert</i> class have been introduced to allow the use of assertion
anywhere.</li>
</ul>

<h2>
<a NAME="Requirement"></a>Requirement</h2>

<ul>
<li>
Operating system : Windows 9x/NT/2000.</li>

<li>
Compiler: Visual C++ 6.0</li>
</ul>

<h2>
<a NAME="Licensing"></a>Licensing</h2>
CppUnit is covered by the <a href="License-GPL.txt">Gnu Public License</a>.
<h2>
<a NAME="Download"></a>Download</h2>
&nbsp;&nbsp;&nbsp; As this version of CppUnit is temporary, I'll named
it "CppUnitW".
<p><a href="CppUnitW-1_2.zip">CppUnitW 1.2:</a> includes source and documentation
for VC++ and Unix. (200Ko).
<br><a href="CppUnitW-1_1.zip">CppUnitW 1.1</a>: includes source and documentation.
(233Ko).
<h2>
<a NAME="Questions"></a>Questions, comments and bugs reports</h2>
&nbsp;&nbsp;&nbsp; Questions, comments and bugs reports are more than welcome.
You can reach me at the following address: <a href="mailto:gaiacrtn@free.fr">gaiacrtn@free.fr</a>
<br>&nbsp;&nbsp;&nbsp; Features would be better discussed on the <a href="http://sourceforge.net/projects/cppunit/">cppunit
mailing list</a> (follow the link and click on list).
<h2>
<a NAME="GettingStarted"></a>Getting Started</h2>

<blockquote>
<h3>
<a NAME="CompilingTheSample"></a>Compiling the samples</h3>
</blockquote>
<a href="#Download">Download</a> and unzip your version of CppUnitW.
<p>The physical layout is as follow:
<pre>CppUnit/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The directory contained in the zip file.
&nbsp; doc/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Contains some documentation about unit testing.
&nbsp;&nbsp;&nbsp; index.html&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This page (without images).
&nbsp; examples/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Some examples.
&nbsp;&nbsp;&nbsp; Example.dsw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VC++ workspace for the <i>hierarchy</i> example.
&nbsp;&nbsp;&nbsp; hierarchy/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source of a text test runner based example.
&nbsp;&nbsp;&nbsp; msvc6/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VC++ specific examples (use the graphic TestRunner)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HostApp/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source of a graphic test runner based example.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>HostApp.dsw</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workspace to compile the graphic test runner based example.
&nbsp; Lib/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Target directory for the compiled dll and libraries.
&nbsp; src/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source (cppunit should move there...)
&nbsp;&nbsp;&nbsp; cppunit/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source for the CppUnit library and private headers.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; CppUnit.dsw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Workspace to compile the cppunit static library.
&nbsp;&nbsp;&nbsp; msvc6/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source specific to VC++ platform.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TestRunner/:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Source of the graphic test runner dynamic library.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TestRunner.dsw&nbsp;&nbsp; Workspace to compile the graphic test runner.</pre>
Now, to run your first sample:
<ol>
<li>
Your lucky:</li>

<br>Open HostApp.dsw with VC++. Make the HostApp the active project (right
click on the project in the file tab). Run the project, the dependencies
setting should automatically compile the cppunitd.lib and testrunnerd.dll.
<li>
It's not your day:</li>

<ul>
<li>
Open CppUnit.dsw, select the debug configuration and compile. The resulting
static library is placed in the <i>Lib</i> directory and is named CppUnitd.lib.
It is compiled against the <i>debug multithread dll </i>runtime library.</li>

<li>
Open TestRunner.dsw, select the debug configuration and compile. The resulting
library os placed in the <i>Lib</i> directory. The file are named <i>TestRunnerd.lib
</i>and
<i>TestRunnerd.dll</i>.
It is compiled against the <i>debug multithreaded dll</i> runtime library
and use the <i>MFC shared DLL</i>. It is an <i>MFC extension DLL</i>.</li>

<li>
Open HostApp.dsw, make the HostApp project active, pray and compile!</li>
</ul>

<h3>
<a NAME="UsingTheTestRunner"></a>Using the test runner</h3>
Well, you can now run the <i>HostApp</i> example you just compiled. You
should see something like this:</ol>
<img SRC="TestRunnerDlg.jpg" height=374 width=611>
<p>&nbsp;&nbsp;&nbsp; The top combo box show the most recently used test.
You select a test using the button <i>Browse</i> (that's a new feature).
When a test is run using the <i>Run</i> button, the color of the progress
bar indicates if a test has failed (red) or not (green). The list below
show details about the failed test.
<br>&nbsp;&nbsp;&nbsp; The autorun check box indicates is the most recently
used test must be automatically run when the test runner is opened.
<br>&nbsp;&nbsp;&nbsp; All those settings are stored in the host application
registry in the CppUnit section (allowing per application setting and more
recently used test list).
<br>&nbsp;&nbsp;&nbsp; Pressing the spacebar will run the selected test.
<br>&nbsp;&nbsp;&nbsp; Pressing 'Q' will send a <tt>WM_QUIT</tt> message
to the host application, which should result in exiting the host application.
<p><img SRC="BrowseForTestDlg.jpg" height=231 width=395>
<p>&nbsp;&nbsp;&nbsp; The above dialog appears when you click on <i>Browse</i>
button. You select the test you want to run with this dialog. You can explore
the hierarchy of tests.
<blockquote>
<h3>
<a NAME="CreatingTestCase"></a>Creating test case</h3>
</blockquote>
&nbsp;&nbsp;&nbsp; One of the major improvement of this version over other
is the creation of test case.
<p>&nbsp;&nbsp;&nbsp; For the first comer who had never used cppunit, I
would recommend to first try using the macro, since it's easier to set
up, then switch to the template helper such as <i>TestSuiteBuilder</i>
once they get a feeling of how it works. Macros makes it easy, but you
can't build upon the existing framework using them.
<blockquote>
<blockquote>
<h4>
<a NAME="TheWayOfMacros"></a>The way of macros</h4>
</blockquote>
</blockquote>
&nbsp;&nbsp;&nbsp; First, you must create a class that inherit <i>CppUnit::TestCase</i>,
the base class for all test case:
<blockquote>
<pre>#include &lt;cppunit/TestCase.h>
#include &lt;cppunit/extensions/HelperMacros.h></pre>

<pre>class ExampleTestCase : public CppUnit::TestCase {</pre>
</blockquote>
&nbsp;&nbsp;&nbsp; Then, you declares the test suite for this test case,
and all the methods to run for this test case:
<blockquote>
<pre>&nbsp; CU_TEST_SUITE( ExampleTestCase );
&nbsp; CU_TEST( example );
&nbsp; CU_TEST( anotherExample );&nbsp;
&nbsp; CU_TEST( testAdd );
&nbsp; CU_TEST( testDivideByZero );
&nbsp; CU_TEST( testEquals );
&nbsp; CU_TEST_SUITE_END();
public:
&nbsp; ...</pre>
</blockquote>
&nbsp;&nbsp;&nbsp; The macro <tt>CU_TEST_SUITE</tt> actually declares a
bunch of typedef, implements the static method <tt>suite()</tt> which returns
the suite for this test case, and start implementing a template method
named <tt>registerTests</tt>.
<br>&nbsp;&nbsp;&nbsp; The macro <tt>CU_TEST</tt> actually adds the specified
method to the suite, behind the scene, the traditional <tt>CppUnit::TestCaller</tt>
is used.
<br>&nbsp;&nbsp;&nbsp; The macro <tt>CU_TEST_SUITE_END</tt> ends the method
<tt>registerTests</tt>
that we were defining.
<p>&nbsp;&nbsp;&nbsp; What do we have at that point:
<ul>
<li>
a method <tt>static CppUnit::Test *suite()</tt> has been automatically
added to the test case,</li>

<li>
a suite automatically named after the test case class, the name is extracted
from RTTI information (<tt>type_info</tt>), which also contains the namespace,</li>

<li>
a bunch of TestCaller wrapping a call to each test method added to the
suite. The name for each test is: suite name '.' method name,</li>

<li>
a public typedef to an AutoRegisterSuite,</li>
</ul>
&nbsp;&nbsp;&nbsp; All we need now it to register the suite to the test
registry (a object that store a collection of test that can be later retrieved.
Great to reduce dependency). You can do this by using the following macro
in the implementation file of your class (.cpp):
<p>&nbsp;&nbsp;&nbsp; #include "ExampleTestCase.h"
<p>&nbsp;&nbsp;&nbsp; <tt>CU_TEST_SUITE_REGISTRATION( ExampleTestCase );</tt>
<p>&nbsp;&nbsp;&nbsp; The macro <tt>CU_TEST_SUITE_REGISTRATION</tt> defines
a static variable of type <tt>CppUnit::AutoRegisterSuite</tt>, with the
specified class type. When this variable will be initialized (at static
initialization time), it will retrieve the <tt>suite()</tt> of the class
and register it to the TestRegistry. The parameter is the type of the test
case, for example, <tt>CU_TEST_SUITE_REGISTRATION( ChessTest&lt;Chess>
)</tt> is used to register a template test case.
<p>&nbsp;&nbsp;&nbsp; This great thing about this is that it works just
fine with template! No more TestCaller instantiation of the death.
<p>&nbsp;&nbsp;&nbsp; There is one thing that remaining: how to sub-class
a test case ? The macros makes it very easy, instead of using <tt>CU_TEST_SUITE</tt>
to declare the suite, you do as follow:
<blockquote>
<pre>class SimpleSubTest : public SimpleTest {
<b>&nbsp; CU_TEST_SUB_SUITE( SimpleSubTest, SimpleTest );
</b>&nbsp; CU_TEST( testAdd );
&nbsp; CU_TEST( testSub );
&nbsp; CU_TEST_SUITE_END();
public:
&nbsp; ...</pre>
</blockquote>
&nbsp;&nbsp;&nbsp; As you can see, you must use the macro <tt>CU_TEST_SUB_SUITE</tt>
and specify the base class as well as the test case class. That's all,
it's all done!
<blockquote>
<blockquote>
<h4>
<a NAME="TheWayOfTemplates"></a>The way of templates</h4>
</blockquote>
</blockquote>
&nbsp;&nbsp;&nbsp; Since your reading this, your are familiar with CppUnit
architecture. One of the thing I found frustrating was the building of
suite. Here you have your traditional template test case:
<blockquote><tt>#include &lt;cppunit/TestCase.h></tt>
<br><tt>#include &lt;cppunit/TestSuite.h></tt>
<p><tt>template&lt;typename CharType></tt>
<br><tt>class StringTest : public TestCase</tt>
<br><tt>{</tt>
<br><tt>public:</tt>
<br><tt>&nbsp; static CppUnit::TestSuite *suite();</tt>
<p><tt>&nbsp; void testAppend();</tt>
<br><tt>&nbsp; void testLength();</tt>
<br><tt>};</tt></blockquote>
&nbsp;&nbsp;&nbsp; Here we created a test case for a string class. The
test case itself is a template parametrized with the type of character
used by the string.
<p>&nbsp;&nbsp;&nbsp; The static method <i>suite()</i> returns a suite
containing the test to run for this test case. Here is the typical way
this method is implemented:
<br>&nbsp;
<blockquote><tt>template&lt;typename CharType></tt>
<br><tt>CppUnit::TestSuite *</tt>
<br><tt>StringTest&lt;CharType>::suite()</tt>
<br><tt>{</tt>
<br><tt>&nbsp; // Constructs the suite naming it after the test case class
name...</tt>
<br><tt>&nbsp; CppUnit::TestSuite *suite = new CppUnit::TestSuite( StringTest&lt;CharType>
);</tt>
<p><tt>&nbsp; // adds test caller to the suite for each of the test method.</tt>
<br><tt>&nbsp; suite->addTest( new CppUnit::TestCaller&lt; StringTest&lt;CharType>
>(</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"testAppend",</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&amp;StringTest&lt;CharType>::testAppend ) );</tt>
<br><tt>&nbsp; suite->addTest( new CppUnit::TestCaller&lt; StringTest&lt;CharType>
>(</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"testLength",</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&amp;StringTest&lt;CharType>::testLength ) );</tt>
<br><tt>}</tt></blockquote>
&nbsp;&nbsp;&nbsp; I found that very hard to read and maintain, so I created
a helper template class to make it easier. This is the <i>TestSuiteBuilder</i>.
Here is how to use it:
<blockquote>#include &lt;cppunit/extensions/TestSuiteBuilder.h>
<p>[...]
<p><tt>template&lt;typename CharType></tt>
<br><tt>CppUnit::TestSuite *</tt>
<br><tt>StringTest&lt;CharType>::suite()</tt>
<br><tt>{</tt>
<br><tt>&nbsp; CppUnit::TestSuiteBuilder&lt; StringTest&lt;CharType> >
suite;</tt>
<p><tt>&nbsp; suite.addTestCaller( "testAppend", testAppend );</tt>
<br><tt>&nbsp; suite.addTestCaller( "testLength", testLength );</tt>
<br><tt>}</tt></blockquote>
&nbsp;&nbsp;&nbsp; As you can see it much readable...
<p>&nbsp;&nbsp;&nbsp; You still have to pass the suite to the test runner.
There is two ways to do that:
<p>&nbsp;&nbsp;&nbsp; You can use the <i>TestFactoryRegistry</i>:
<blockquote>&nbsp;&nbsp;&nbsp; #include &lt;cppunit/extensions/AutoRegisterSuite.h>
<p>&nbsp;&nbsp;&nbsp; static CppUnit::AutoRegisterSuite&lt; <tt>StringTest&lt;CharType>
> suite__;</tt></blockquote>
&nbsp;&nbsp;&nbsp; This will create a <i>TestSuiteFactory</i> for the specified
class and register it to the <i>TestFactoryRegistry</i>.
<blockquote>
<h3>
<a NAME="UsingTheTestRunner"></a>Using TestRunner from your application</h3>
</blockquote>
&nbsp;&nbsp;&nbsp; Now, we still need to run those test case. This is a
really simple thing to do. You need to plug a bunch of code in your application.
I like to do this in the <tt>InitInstance()</tt>, after everything is initialized,
and with a magic key. In the <i>HostApp</i> example, it is done in <tt>CHostAppDoc::OnNewDocument()</tt>.
<p>&nbsp;&nbsp;&nbsp; Here is what you need to do if you are using the
<i>TestFactoryRegistry
</i>(the <i><tt>CU_TEST_SUITE_REGISTRATION</tt></i> macro or the template
<i><tt>AutoRegisterSuite</tt></i>):
<pre>#include &lt;TestRunner/TestRunner.h>
#include &lt;cppunit/extensions/TestFactoryRegistry.h>

[...]</pre>

<pre>CHostAppDoc::OnNewDocument()
{
<tt>&nbsp;&nbsp;&nbsp; TestRunner runner;
</tt>&nbsp;&nbsp;&nbsp; runner.addTest ( CppUnit::TestFactoryRegistry::getRegistry().makeTest() );
&nbsp;&nbsp;&nbsp; // open and run the test runner dialog...
<tt>&nbsp;&nbsp;&nbsp; runner.run();

</tt>&nbsp;&nbsp;&nbsp; [...]
}</pre>
&nbsp;&nbsp;&nbsp; And if you want to do it the traditional way:
<pre>#include &lt;TestRunner/TestRunner.h>
#include "StringTest.h"
#include "ExampleTestCase.h"</pre>

<pre>[...]</pre>

<pre>CHostAppDoc::OnNewDocument()
{
<tt>&nbsp;&nbsp;&nbsp; TestRunner runner;
</tt>&nbsp;&nbsp;&nbsp; runner.addTest( StringTest&lt;char>::suite() );
&nbsp;&nbsp;&nbsp; runner.addTest( StringTest&lt;wchar_t>::suite() );
&nbsp;&nbsp;&nbsp; runner.addTest( ExampleTestCase::suite() );
<tt>&nbsp;&nbsp;&nbsp; runner.run();

</tt>&nbsp;&nbsp;&nbsp; [...]
}</pre>

<blockquote>
<h3>
<a NAME="CompilingWithCppUnit"></a>Compiling with CppUnit and TestRunner</h3>
</blockquote>
&nbsp;&nbsp;&nbsp; For the includes, there is two ways:
<ul>
<li>
Adding the <tt>CppUnit/include</tt> directory (the one contained in the
zip which is parent of <i>cppunit</i> and <i>TestRunner</i>) in the Tools/Options/Directories
tab,</li>

<li>
Adding <tt>CppUnit/include</tt> in the Project Settings/C++/Preprocessor/Additional
include directories (It allow to use more than one version of CppUnit,
and anybody can take the project and compile it without have to change
its setting).</li>
</ul>
&nbsp;&nbsp;&nbsp; For the library, you need to link <i>CppUnitd.lib </i>and
<i>TestRunnerd.lib</i>,
which are in the <i>Lib</i> directory. You specify that in Project Settings/Link/General/Library
modules. You can you either relative path, or adds the <i>Lib</i> directory
in the Tools/Options/Directories tab.
<br>&nbsp;&nbsp;&nbsp; Don't forget to enable the RTTI in Project Settings/C++/C++
Language. They are required to get the test case name (among other things).
<p>&nbsp;&nbsp;&nbsp; <b>Warning:</b> when running your application, the
TestRunnerd.dll which is in the <i>Lib</i> directory need to be the path
(see ::LoadLibrary documentation for loading order). I usually ensure that
the DLL is in the debug directory by adding a post build "copy" command.
See Project Settings/Post-build Step from the <i>HostApp</i> example for
detail.
<h2>
<a NAME="KnownBugs"></a>Known bugs</h2>
Well, I run into some problem when using the test runner:
<ul>
<li>
The icons don't appear in the test browser (this happen only in one of
my applications). I just don't get it, no error is reported when the image
list is created or when item are insert. The only difference I found until
now is that this application was created using VC++ 5.0. Let me know if
you find anything to help.</li>

<li>
The 'Q' which do <tt>app->PostThreadMessage( WM_QUIT, 0, 0 )</tt>, will
sometime assert. I still haven't got the time to look into that one (I'm
probably using the wrong method to quit the application).</li>
</ul>

<hr SIZE=1 WIDTH="100%"><font size=-2>Copyright &copy;2000, <a href="mailto:gaiacrtn@free.fr">Baptiste
Lepilleur</a>. <a href="http://gaiacrtn.free.fr/index.html">http://gaiacrtn.free.fr/index.html</a></font>
</body>
</html>
